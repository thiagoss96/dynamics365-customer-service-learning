# üìÖ Fluxo Power Automate: Exportar reuni√µes di√°rias do Outlook para Excel
 
Este guia ensina passo a passo como criar um fluxo no Power Automate que coleta todas as reuni√µes do dia e registra no Excel, incluindo lista de participantes.
 
> **Dica:** Voc√™ pode adicionar imagens de cada passo adicionando links com Markdown: `![descri√ß√£o](link-da-imagem)`
 
## 1Ô∏è‚É£ Criar fluxo automatizado com gatilho de Recurrence
 
1. Abra o Power Automate.
2. Clique em **Criar**.
3. Escolha **Fluxo agendado (Recurrence)**.
4. Configure:
   - Intervalo: **1**
   - Frequ√™ncia: **Dia**
   - Fuso Hor√°rio: **(UTC-03:00) Bras√≠lia**
   - Executar em: **18:00**
 
![Imagem do passo 1](link-da-imagem-1)
 
Clique em **Criar**.
 
---
 
## 2Ô∏è‚É£ Inicializar Vari√°veis
 
### üü¢ Vari√°vel: InicioJanela
- A√ß√£o: **Inicializar vari√°vel**
- Nome: **InicioJanela**
- Tipo: **Cadeia de caracteres**
- Valor:
  ```
  @{formatDateTime(addHours(startOfDay(utcNow()), 6), 'yyyy-MM-ddTHH:mm:ssZ')}
  ```
![Imagem do passo 2 - InicioJanela](link-da-imagem-2)
 
### üîµ Vari√°vel: FimJanela
- A√ß√£o: **Inicializar vari√°vel**
- Nome: **FimJanela**
- Tipo: **Cadeia de caracteres**
- Valor:
  ```
  @{formatDateTime(addHours(startOfDay(utcNow()), 22), 'yyyy-MM-ddTHH:mm:ssZ')}
  ```
![Imagem do passo 2 - FimJanela](link-da-imagem-3)
 
---
 
## 3Ô∏è‚É£ Obter eventos do Outlook
 
A√ß√£o: **Obter o modo de exibi√ß√£o Calend√°rio de eventos (V3)**
 
- **ID do calend√°rio:** normalmente use "Calendar".
- **Hora de In√≠cio:** `@{variables('InicioJanela')}`
- **Hora de T√©rmino:** `@{variables('FimJanela')}`
 
![Imagem do passo 3](link-da-imagem-4)
 
---
 
## 4Ô∏è‚É£ Inicializar vari√°veis de participantes
 
### üü° ListaParticipantesString
- Nome: **ListaParticipantesString**
- Tipo: **Cadeia de caracteres**
- Valor: *(deixe em branco)*
 
### üü† ListaParticipantes (Matriz)
- Nome: **ListaParticipantes**
- Tipo: **Matriz**
- Valor: *(deixe em branco)*
 
![Imagem do passo 4](link-da-imagem-5)
 
---
 
## 5Ô∏è‚É£ Aplicar a cada ‚Äì percorrer eventos
 
A√ß√£o: **Aplicar a cada**
 
Selecione a sa√≠da:
```
@{outputs('Obter_o_modo_de_exibi√ß√£o_Calend√°rio_de_eventos_(V3)')?['body/value']}
```
 
Dentro dele, adicione:
 
### 5.1) Definir vari√°vel ‚Äì ListaParticipantesString
- Valor: `@{concat(items('Aplicar_a_cada')?['requiredAttendees'], items('Aplicar_a_cada')?['optionalAttendees'])}`
 
### 5.2) Definir vari√°vel ‚Äì ListaParticipantes (Matriz)
- Valor: `@{split(variables('ListaParticipantesString'), ';')}`
 
![Imagem do passo 5](link-da-imagem-6)
 
---
 
## 6Ô∏è‚É£ Aplicar a cada 2 ‚Äì percorrer lista de participantes
 
A√ß√£o: **Aplicar a cada 1**
 
Entrada: `@{variables('ListaParticipantes')}`
 
### A√ß√£o: Adicionar uma linha em uma tabela ‚Äì Excel
- Localiza√ß√£o: **OneDrive for Business**
- Biblioteca de Documentos: **Documentos**
- Arquivo: selecione *arquivoexcel.xlsx*
- Tabela: **Tabela1**
 
Campos:
- Assunto: `@{items('Aplicar_a_cada')?['subject']}`
- In√≠cio: `@{formatDateTime(convertTimeZone(items('Aplicar_a_cada')?['Start'],'UTC','E. South America Standard Time'),'yyyy/MM/dd HH:mm:ss')}`
- T√©rmino: `@{formatDateTime(convertTimeZone(items('Aplicar_a_cada')?['end'],'UTC','E. South America Standard Time'),'yyyy/MM/dd HH:mm:ss')}`
- Participantes: `@{items('Aplicar_a_cada_1')}`
 
![Imagem do passo 6](link-da-imagem-7)
 
---
 
## 7Ô∏è‚É£ Salvar o fluxo
 
Clique em **Salvar** e d√™ o nome que desejar.
 
Este fluxo executa diariamente √†s 18h, varre todas as reuni√µes do dia e registra no Excel assunto, hor√°rio e participantes üìä ‚Äî perfeito para projetos que exigem controle de horas ou an√°lise de agendas.
 
![Imagem do passo 7](link-da-imagem-8)
 
Fim.
